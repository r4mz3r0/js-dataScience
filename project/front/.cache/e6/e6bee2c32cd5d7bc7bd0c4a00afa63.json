{"id":"node_modules/vega-lite/build/src/compile/header/index.js","dependencies":[{"name":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js.map","includedInParent":true,"mtime":499162500000},{"name":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/package.json","includedInParent":true,"mtime":1593715260815},{"name":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/package.json","includedInParent":true,"mtime":499162500000},{"name":"tslib","loc":{"line":3,"column":22},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/tslib/tslib.es6.js"},{"name":"vega-util","loc":{"line":7,"column":26},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-util/index.js"},{"name":"../../fielddef","loc":{"line":8,"column":25},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/fielddef.js"},{"name":"../../header","loc":{"line":9,"column":23},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/header.js"},{"name":"../../sort","loc":{"line":10,"column":21},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/sort.js"},{"name":"../../util","loc":{"line":11,"column":21},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/util.js"},{"name":"../common","loc":{"line":12,"column":23},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/common.js"},{"name":"../data/calculate","loc":{"line":13,"column":26},"parent":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/header/index.js","resolved":"/home/ramsiro/Desktop/JavaScriptDataScience/js-dataScience/project/front/node_modules/vega-lite/build/src/compile/data/calculate.js"}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\n/**\n * Utility for generating row / column headers\n */\nvar vega_util_1 = require(\"vega-util\");\nvar fielddef_1 = require(\"../../fielddef\");\nvar header_1 = require(\"../../header\");\nvar sort_1 = require(\"../../sort\");\nvar util_1 = require(\"../../util\");\nvar common_1 = require(\"../common\");\nvar calculate_1 = require(\"../data/calculate\");\nexports.HEADER_CHANNELS = ['row', 'column'];\nexports.HEADER_TYPES = ['header', 'footer'];\nfunction getHeaderType(orient) {\n    if (orient === 'top' || orient === 'left') {\n        return 'header';\n    }\n    return 'footer';\n}\nexports.getHeaderType = getHeaderType;\nfunction getTitleGroup(model, channel) {\n    var title = model.component.layoutHeaders[channel].title;\n    var textOrient = channel === 'row' ? 'left' : undefined;\n    var config = model.config ? model.config : undefined;\n    var facetFieldDef = model.component.layoutHeaders[channel].facetFieldDef ? model.component.layoutHeaders[channel].facetFieldDef : undefined;\n    return {\n        name: channel + \"-title\",\n        type: 'group',\n        role: channel + \"-title\",\n        title: tslib_1.__assign({ text: title, offset: 10, orient: textOrient, style: 'guide-title' }, getHeaderProperties(config, facetFieldDef, header_1.HEADER_TITLE_PROPERTIES, header_1.HEADER_TITLE_PROPERTIES_MAP))\n    };\n}\nexports.getTitleGroup = getTitleGroup;\nfunction getHeaderGroups(model, channel) {\n    var layoutHeader = model.component.layoutHeaders[channel];\n    var groups = [];\n    for (var _i = 0, HEADER_TYPES_1 = exports.HEADER_TYPES; _i < HEADER_TYPES_1.length; _i++) {\n        var headerType = HEADER_TYPES_1[_i];\n        if (layoutHeader[headerType]) {\n            for (var _a = 0, _b = layoutHeader[headerType]; _a < _b.length; _a++) {\n                var headerCmpt = _b[_a];\n                groups.push(getHeaderGroup(model, channel, headerType, layoutHeader, headerCmpt));\n            }\n        }\n    }\n    return groups;\n}\nexports.getHeaderGroups = getHeaderGroups;\n// 0, (0,90), 90, (90, 180), 180, (180, 270), 270, (270, 0)\nfunction labelAlign(angle) {\n    // to keep angle in [0, 360)\n    angle = ((angle % 360) + 360) % 360;\n    if ((angle + 90) % 180 === 0) { // for 90 and 270\n        return {}; // default center\n    }\n    else if (angle < 90 || 270 < angle) {\n        return { align: { value: 'right' } };\n    }\n    else if (135 <= angle && angle < 225) {\n        return { align: { value: 'left' } };\n    }\n    return {};\n}\nexports.labelAlign = labelAlign;\nfunction labelBaseline(angle) {\n    // to keep angle in [0, 360)\n    angle = ((angle % 360) + 360) % 360;\n    if (45 <= angle && angle <= 135) {\n        return { baseline: 'top' };\n    }\n    return { baseline: 'middle' };\n}\nexports.labelBaseline = labelBaseline;\nfunction getSort(facetFieldDef, channel) {\n    var sort = facetFieldDef.sort;\n    if (sort_1.isSortField(sort)) {\n        return {\n            field: fielddef_1.vgField(sort, { expr: 'datum' }),\n            order: sort.order || 'ascending'\n        };\n    }\n    else if (vega_util_1.isArray(sort)) {\n        return {\n            field: calculate_1.sortArrayIndexField(facetFieldDef, channel, 'datum'),\n            order: 'ascending'\n        };\n    }\n    else {\n        return {\n            field: fielddef_1.vgField(facetFieldDef, { expr: 'datum' }),\n            order: sort || 'ascending'\n        };\n    }\n}\nfunction getHeaderGroup(model, channel, headerType, layoutHeader, headerCmpt) {\n    var _a;\n    if (headerCmpt) {\n        var title = null;\n        var facetFieldDef = layoutHeader.facetFieldDef;\n        if (facetFieldDef && headerCmpt.labels) {\n            var _b = facetFieldDef.header, header = _b === void 0 ? {} : _b;\n            var format = header.format, labelAngle = header.labelAngle;\n            var config = model.config ? model.config : undefined;\n            var update = tslib_1.__assign({}, labelAlign(labelAngle));\n            title = tslib_1.__assign({ text: common_1.formatSignalRef(facetFieldDef, format, 'parent', model.config), offset: 10, orient: channel === 'row' ? 'left' : 'top', style: 'guide-label' }, getHeaderProperties(config, facetFieldDef, header_1.HEADER_LABEL_PROPERTIES, header_1.HEADER_LABEL_PROPERTIES_MAP), (util_1.keys(update).length > 0 ? { encode: { update: update } } : {}));\n        }\n        var axes = headerCmpt.axes;\n        var hasAxes = axes && axes.length > 0;\n        if (title || hasAxes) {\n            var sizeChannel = channel === 'row' ? 'height' : 'width';\n            return tslib_1.__assign({ name: model.getName(channel + \"_\" + headerType), type: 'group', role: channel + \"-\" + headerType }, (layoutHeader.facetFieldDef ? {\n                from: { data: model.getName(channel + '_domain') },\n                sort: getSort(facetFieldDef, channel)\n            } : {}), (title ? { title: title } : {}), (headerCmpt.sizeSignal ? {\n                encode: {\n                    update: (_a = {},\n                        _a[sizeChannel] = headerCmpt.sizeSignal,\n                        _a)\n                }\n            } : {}), (hasAxes ? { axes: axes } : {}));\n        }\n    }\n    return null;\n}\nexports.getHeaderGroup = getHeaderGroup;\nfunction getHeaderProperties(config, facetFieldDef, properties, propertiesMap) {\n    var props = {};\n    for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n        var prop = properties_1[_i];\n        if (config && config.header) {\n            if (config.header[prop]) {\n                props[propertiesMap[prop]] = config.header[prop];\n            }\n        }\n        if (facetFieldDef && facetFieldDef.header) {\n            if (facetFieldDef.header[prop]) {\n                props[propertiesMap[prop]] = facetFieldDef.header[prop];\n            }\n        }\n    }\n    return props;\n}\nexports.getHeaderProperties = getHeaderProperties;\n"},"sourceMaps":{"js":{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/compile/header/index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Utility for generating row / column headers\n */\nimport {isArray} from 'vega-util';\nimport {Config} from '../../config';\nimport {FacetFieldDef} from '../../facet';\nimport {vgField} from '../../fielddef';\nimport {HEADER_LABEL_PROPERTIES, HEADER_LABEL_PROPERTIES_MAP, HEADER_TITLE_PROPERTIES, HEADER_TITLE_PROPERTIES_MAP, HeaderConfig} from '../../header';\nimport {isSortField} from '../../sort';\nimport {keys} from '../../util';\nimport {AxisOrient, VgAxis, VgComparator, VgMarkGroup, VgTitleConfig} from '../../vega.schema';\nimport {formatSignalRef} from '../common';\nimport {sortArrayIndexField} from '../data/calculate';\nimport {Model} from '../model';\n\n\nexport type HeaderChannel = 'row' | 'column';\nexport const HEADER_CHANNELS: HeaderChannel[] = ['row', 'column'];\n\nexport type HeaderType = 'header' | 'footer';\nexport const HEADER_TYPES: HeaderType[] = ['header', 'footer'];\n\n/**\n * A component that represents all header, footers and title of a Vega group with layout directive.\n */\nexport interface LayoutHeaderComponent {\n  title?: string;\n\n  // TODO: repeat and concat can have multiple header / footer.\n  // Need to redesign this part a bit.\n\n  facetFieldDef?: FacetFieldDef<string>;\n\n  /**\n   * An array of header components for headers.\n   * For facet, there should be only one header component, which is data-driven.\n   * For repeat and concat, there can be multiple header components that explicitly list different axes.\n   */\n  header?: HeaderComponent[];\n\n  /**\n   * An array of header components for footers.\n   * For facet, there should be only one header component, which is data-driven.\n   * For repeat and concat, there can be multiple header components that explicitly list different axes.\n   */\n  footer?: HeaderComponent[];\n}\n\n/**\n * A component that represents one group of row/column-header/footer.\n */\nexport interface HeaderComponent {\n\n  labels: boolean;\n\n  sizeSignal: {signal: string};\n\n  axes: VgAxis[];\n}\n\nexport function getHeaderType(orient: AxisOrient) {\n  if (orient === 'top' || orient === 'left') {\n    return 'header';\n  }\n  return 'footer';\n}\n\nexport function getTitleGroup(model: Model, channel: HeaderChannel) {\n  const title = model.component.layoutHeaders[channel].title;\n  const textOrient = channel === 'row' ? 'left' : undefined;\n  const config = model.config? model.config : undefined;\n  const facetFieldDef = model.component.layoutHeaders[channel].facetFieldDef? model.component.layoutHeaders[channel].facetFieldDef : undefined;\n\n  return {\n    name: `${channel}-title`,\n    type: 'group',\n    role: `${channel}-title`,\n    title: {\n      text: title,\n      offset: 10,\n      orient: textOrient,\n      style: 'guide-title',\n      ...getHeaderProperties(config, facetFieldDef, HEADER_TITLE_PROPERTIES, HEADER_TITLE_PROPERTIES_MAP)\n    }\n  };\n}\n\nexport function getHeaderGroups(model: Model, channel: HeaderChannel): VgMarkGroup[] {\n  const layoutHeader = model.component.layoutHeaders[channel];\n  const groups = [];\n  for (const headerType of HEADER_TYPES) {\n    if (layoutHeader[headerType]) {\n      for (const headerCmpt of layoutHeader[headerType]) {\n        groups.push(getHeaderGroup(model, channel, headerType, layoutHeader, headerCmpt));\n      }\n    }\n  }\n  return groups;\n}\n\n// 0, (0,90), 90, (90, 180), 180, (180, 270), 270, (270, 0)\n\nexport function labelAlign(angle: number) {\n  // to keep angle in [0, 360)\n  angle = ((angle % 360) + 360) % 360;\n  if ((angle + 90) % 180 === 0) {  // for 90 and 270\n    return {}; // default center\n  } else if (angle < 90 || 270 < angle) {\n    return {align: {value: 'right'}};\n  } else if (135 <= angle && angle < 225) {\n    return {align: {value: 'left'}};\n  }\n  return {};\n}\n\nexport function labelBaseline(angle: number) {\n  // to keep angle in [0, 360)\n  angle = ((angle % 360) + 360) % 360;\n  if (45 <= angle && angle <= 135) {\n    return {baseline: 'top'};\n  }\n  return {baseline: 'middle'};\n}\n\nfunction getSort(facetFieldDef: FacetFieldDef<string>, channel: 'row' | 'column'): VgComparator {\n  const {sort} = facetFieldDef;\n  if (isSortField(sort)) {\n    return {\n      field: vgField(sort, {expr: 'datum'}),\n      order: sort.order || 'ascending'\n    };\n  } else if (isArray(sort)) {\n    return {\n      field: sortArrayIndexField(facetFieldDef, channel, 'datum'),\n      order: 'ascending'\n    };\n  } else {\n    return {\n      field: vgField(facetFieldDef, {expr: 'datum'}),\n      order: sort || 'ascending'\n    };\n  }\n}\n\nexport function getHeaderGroup(model: Model, channel: HeaderChannel, headerType: HeaderType, layoutHeader: LayoutHeaderComponent, headerCmpt: HeaderComponent) {\n  if (headerCmpt) {\n    let title = null;\n    const {facetFieldDef} = layoutHeader;\n    if (facetFieldDef && headerCmpt.labels) {\n      const {header = {}} = facetFieldDef;\n      const {format, labelAngle} = header;\n      const config = model.config? model.config : undefined;\n\n      const update = {\n        ...labelAlign(labelAngle)\n      };\n\n      title = {\n        text: formatSignalRef(facetFieldDef, format, 'parent', model.config),\n        offset: 10,\n        orient: channel === 'row' ? 'left' : 'top',\n        style: 'guide-label',\n        ...getHeaderProperties(config, facetFieldDef, HEADER_LABEL_PROPERTIES, HEADER_LABEL_PROPERTIES_MAP),\n        ...(keys(update).length > 0 ? {encode: {update}} : {})\n      };\n    }\n\n    const axes = headerCmpt.axes;\n\n    const hasAxes = axes && axes.length > 0;\n    if (title || hasAxes) {\n      const sizeChannel = channel === 'row' ? 'height' : 'width';\n\n\n\n      return {\n        name: model.getName(`${channel}_${headerType}`),\n        type: 'group',\n        role: `${channel}-${headerType}`,\n        ...(layoutHeader.facetFieldDef ? {\n          from: {data: model.getName(channel + '_domain')},\n          sort: getSort(facetFieldDef, channel)\n        } : {}),\n        ...(title ? {title} : {}),\n        ...(headerCmpt.sizeSignal ? {\n          encode: {\n            update: {\n              [sizeChannel]: headerCmpt.sizeSignal\n            }\n          }\n        }: {}),\n        ...(hasAxes ? {axes} : {})\n      };\n    }\n  }\n  return null;\n}\n\nexport function getHeaderProperties(config: Config, facetFieldDef: FacetFieldDef<string>, properties: string[], propertiesMap: {[k in keyof HeaderConfig]: keyof VgTitleConfig}) {\n  const props = {};\n  for (const prop of properties) {\n    if (config && config.header) {\n      if (config.header[prop]) {\n        props[propertiesMap[prop]] = config.header[prop];\n      }\n    }\n    if (facetFieldDef && facetFieldDef.header) {\n      if (facetFieldDef.header[prop]) {\n        props[propertiesMap[prop]] = facetFieldDef.header[prop];\n      }\n    }\n  }\n  return props;\n}\n"]}},"error":null,"hash":"3ee6fea6440bcb76afbc5dfb8470526c","cacheData":{"env":{}}}